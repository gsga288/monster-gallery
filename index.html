<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>16 ç±»å® ç‰©å‘ˆç°</title>
  <style>
    body, html {
      margin: 0; padding: 0;
      background: #111;
      color: #fff;
      font-family: sans-serif;
      display: flex; flex-direction: column;
      align-items: center;
    }
    #info {
      margin: 20px;
      text-align: center;
      line-height: 1.6;
    }
    #media-container {
      position: relative;
      width: 80vw; max-width: 600px;
      height: 80vh; max-height: 400px;
      background: #222;
      display: flex; justify-content: center; align-items: center;
    }
    #media-container img,
    #media-container video {
      max-width: 100%; max-height: 100%;
    }
    video { background: #000; }
    button {
      margin: 20px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <div id="info">
    <div>â¤ï¸ å¿ƒç‡: <span id="heart"></span></div>
    <div>âœ‹ æŠšæ‘¸è·ç¦»: <span id="touch"></span></div>
    <div>ğŸ”Š å£°éŸ³åˆ†è´: <span id="sound"></span></div>
    <div>â±ï¸ äº’åŠ¨æ—¶é•¿: <span id="time"></span></div>
    <div>åˆ†ç±»ç±»åˆ«: <code id="category"></code></div>
  </div>

  <div id="media-container"></div>

  <button id="reload">ğŸ”„ å†æ¥ä¸€æ¬¡</button>

<script>
// â€”â€” 1. å››ä¸ªå‚æ•°éšæœºç”Ÿæˆ â€”â€” 
function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}
function genParams() {
  return {
    heart: randomInt(60,100),      // 60-100
    touch: randomInt(0,50),        // 0-50
    sound: randomInt(0,120),       // 0-120
    time:  randomInt(0,100)        // 0-100
  };
}

// â€”â€” 2. å‚æ•°åˆ°äºŒå€¼çš„æ˜ å°„è§„åˆ™ â€”â€” 
function toBit(val, threshold) {
  return val > threshold ? '1' : '0';
}
function categorize(p) {
  // å¿ƒç‡ 60-80 â†’ æ–‡é™(0) / 81-100 â†’ æ´»è·ƒ(1)
  const b0 = toBit(p.heart, 80);
  // æŠšæ‘¸ 0-25 â†’ äº²è¿‘(0) / 26-50 â†’ ç–è¿œ(1)
  const b1 = toBit(p.touch, 25);
  // å£°éŸ³ 0-80 â†’ æ”¾æ¾(0) / 81-120 â†’ è­¦è§‰(1)
  const b2 = toBit(p.sound, 80);
  // äº’åŠ¨ 0-30 â†’ è¯•æ¢(0) / 31-100 â†’ äº²å¯†(1)
  const b3 = toBit(p.time, 30);
  return b0 + b1 + b2 + b3;       // e.g. "0101"
}

// â€”â€” 3. 16 ç±»åª’ä½“æ˜ å°„ â€”â€” 
// è¿™é‡Œæˆ‘ä»¬ä¸ç¡¬ç¼–ç æ¯ä¸ªæ–‡ä»¶åï¼Œè€Œæ˜¯åŠ¨æ€è¯»å–ç›®å½•â€¦â€¦
// ä½†å‰ç«¯æ— æ³•ç›´æ¥åˆ—ç›®å½•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æå‰å†™ä¸€ä»½æ¸…å•ã€‚
// å¦‚æœä½ æœ‰å›ºå®šæ–‡ä»¶åï¼Œæ¯”å¦‚ img1.pngã€vid1.mp4â€¦â€¦
// ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œåˆ—å‡ºã€‚ç¤ºä¾‹ä¸­æˆ‘å‡è®¾æ¯ä¸ªç›®å½•ä¸‹åªæœ‰ a.mp4,b.png ä¸¤ä¸ªæ–‡ä»¶ï¼š
const MEDIA_MAP = {
  "0000": [
    "media/calm_friendly_relaxed_cautious/a.png",
    "media/calm_friendly_relaxed_cautious/b.mp4"
  ],
  "0001": [
    "media/calm_friendly_relaxed_loving/a.png",
    "media/calm_friendly_relaxed_loving/b.mp4"
  ],
  "0010": [
    "media/calm_friendly_alert_cautious/a.png",
    "media/calm_friendly_alert_cautious/b.mp4"
  ],
  "0011": [
    "media/calm_friendly_alert_loving/a.png",
    "media/calm_friendly_alert_loving/b.mp4"
  ],
  "0100": [
    "media/calm_reserved_relaxed_cautious/a.png",
    "media/calm_reserved_relaxed_cautious/b.mp4"
  ],
  "0101": [
    "media/calm_reserved_relaxed_loving/a.png",
    "media/calm_reserved_relaxed_loving/b.mp4"
  ],
  "0110": [
    "media/calm_reserved_alert_cautious/a.png",
    "media/calm_reserved_alert_cautious/b.mp4"
  ],
  "0111": [
    "media/calm_reserved_alert_loving/a.png",
    "media/calm_reserved_alert_loving/b.mp4"
  ],
  "1000": [
    "media/excited_friendly_relaxed_cautious/a.png",
    "media/excited_friendly_relaxed_cautious/b.mp4"
  ],
  "1001": [
    "media/excited_friendly_relaxed_loving/a.png",
    "media/excited_friendly_relaxed_loving/b.mp4"
  ],
  "1010": [
    "media/excited_friendly_alert_cautious/a.png",
    "media/excited_friendly_alert_cautious/b.mp4"
  ],
  "1011": [
    "media/excited_friendly_alert_loving/a.png",
    "media/excited_friendly_alert_loving/b.mp4"
  ],
  "1100": [
    "media/excited_reserved_relaxed_cautious/a.png",
    "media/excited_reserved_relaxed_cautious/b.mp4"
  ],
  "1101": [
    "media/excited_reserved_relaxed_loving/a.png",
    "media/excited_reserved_relaxed_loving/b.mp4"
  ],
  "1110": [
    "media/excited_reserved_alert_cautious/a.png",
    "media/excited_reserved_alert_cautious/b.mp4"
  ],
  "1111": [
    "media/excited_reserved_alert_loving/a.png",
    "media/excited_reserved_alert_loving/b.mp4"
  ]
};


// â€”â€” 4. ä¸»å‡½æ•°ï¼šç”Ÿæˆã€åˆ†ç±»ã€å±•ç¤º â€”â€” 
function render() {
  const p = genParams();
  document.getElementById('heart').textContent = p.heart;
  document.getElementById('touch').textContent = p.touch;
  document.getElementById('sound').textContent = p.sound;
  document.getElementById('time').textContent  = p.time;

  const cat = categorize(p);
  document.getElementById('category').textContent = cat;

  const list = MEDIA_MAP[cat] || [];
  if (!list.length) {
    console.warn(`ç±» ${cat} ä¸‹æ²¡æœ‰é…ç½®åª’ä½“`);
    return;
  }
  // éšæœºæŒ‘ä¸€ä¸ª
  const chosen = list[Math.floor(Math.random()*list.length)];

  const container = document.getElementById('media-container');
  container.innerHTML = '';  // æ¸…ç©º
if (chosen.endsWith('.mp4')) {
  const v = document.createElement('video');
  v.src = chosen;
  v.autoplay = true;
  v.loop     = true;
  v.muted    = true;     // å…å»é™éŸ³æ£€æµ‹
  v.playsInline = true;  // iOS/Android éƒ½åŠ ä¸Š
  v.preload = 'auto';    // æå‰ç¼“å†²
  v.setAttribute('playsinline', ''); 
  container.appendChild(v);
} else {
    const img = document.createElement('img');
    img.src = chosen;
    container.appendChild(img);
  }
}

// â€”â€” 5. ç»‘å®šæŒ‰é’® & é¦–æ¬¡æ¸²æŸ“ â€”â€” 
document.getElementById('reload')
  .addEventListener('click', render);

render();
</script>

</body>
</html>
